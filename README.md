# モデリング事例

## 一般化線形モデル（Generalized Linear Model、GLM）<br>

　統計学や機械学習において、応答変数が連続値である回帰分析や、カテゴリ変数である分類分析などに使用される統計モデル。<br>

## 一般化線形モデルの構成要素

1. 線形予測子<br>
  応答変数の値を説明するために、予測変数（説明変数、独立変数とも呼ばれます）の重み付き和を求める。この重みを線形予測子と呼ぶ。<br>

2. リンク関数<br>
  線形予測子を応答変数の値に変換する関数。線形予測子が実数全体を取り得るため、この変換によって応答変数の取り得る範囲に制限を設ける。
  一般的に、リンク関数は正規分布、ポアソン分布、二項分布などの分布によって異なる。<br>

3. 分布族<br>
  応答変数の確率分布を決定する。正規分布、ポアソン分布、二項分布などが一般的に使用される。<br>


## 一般化線形モデルの種類<br>

- 線形回帰モデル<br>
  応答変数が連続値の場合に使用される。リンク関数には恒等関数を使用し、分布族は正規分布を仮定する。<br>
  
  モデル式<br>
  $y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_p x_p + \epsilon$<br>
  
  解法<br>
  最小二乗法<br>

- ロジスティック回帰モデル<br>
  応答変数が2値の場合に使用される。リンク関数にはロジット関数を使用し、分布族は二項分布を仮定する<br>
  
  モデル式<br>
  $\ln\left(\frac{p}{1-p}\right) = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_p x_p$
  
  解法<br>
  最尤推定法<br>
  
  尤度関数<br>
  $L(\beta) = \prod_{i=1}^{n}p_i^{y_i}(1-p_i)^{1-y_i}$

- ポアソン回帰モデル<br>
  応答変数が非負の整数の場合に使用する。リンク関数には対数関数を使用し、分布族はポアソン分布を仮定する<br>
  
  モデル式<br>
  $\ln(\mu) = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_p x_p$
  
  解法<br>
  最尤推定法<br>
  
  尤度関数<br>
  $L(\beta) = \prod_{i=1}^{n}\frac{\mu_i^{y_i}e^{-\mu_i}}{y_i!}$

- ガンマ回帰モデル<br>
  応答変数が正の連続値の場合に使用する。リンク関数には逆関数を使用し、分布族はガンマ分布を仮定する<br>
  
  モデル式<br>
  $y \sim \text{Gamma}(\alpha, \beta)$

  $\ln(y) = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_p x_p$
  
  解法<br>
  最尤推定法<br>
  
  尤度関数<br>
  $L(\beta) = \prod_{i=1}^{n}\frac{\beta^\alpha}{\Gamma(\alpha)}y_i^{\alpha-1}e^{-\beta y_i}$

- 二項ロジット回帰モデル<br>
  応答変数が2値でなく、成功確率が既知の場合に使用する。リンク関数にはロジット関数を使用し、分布族は二項分布を仮定する。<br>
  
  モデル式<br>
  $y \sim \text{Binomial}(n, p)$

  $\ln\left(\frac{p}{1-p}\right) = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_p x_p$
  
  解法<br>
  最尤推定法<br>
  
  尤度関数<br>
  $L(\beta) = \prod_{i=1}^{n}{n\choose y_i}p_i^{y_i}(1-p_i)^{n-y_i}$

### その他
- ゼロインフレーションモデル<br>
  応答変数が0を多く含むカウントデータの場合に使用する。<br>
  2つの確率変数を持ち、1つ目は0が出る確率が高い分布、2つ目は0以外の値が出る確率が高い分布を仮定する。<br>

- 多項分布回帰モデル<br>
  応答変数が複数のカテゴリ値をとる場合に使用する。<br>
  リンク関数にはソフトマックス関数を使用し、分布族は多項分布を仮定する。<br>

なお、これら以外にも応答変数の種類や分布に応じて、様々な拡張が存在する。<br>
一般化線形モデルは、柔軟性が高く、様々な応答変数に対応できるため、幅広い分野で使用される。<br>
